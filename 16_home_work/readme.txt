пробуем открыть файл для чтения, если файл нельзя открыть пишем ошибку
создаем регулярки: отдельно для ip, методов, регулярка с разбитием на группы: ip, метод, url, код ответа, время запроса
если встречаем в логе строку, где нет данных по регуляркам пропускаем эту строку
в цикле считаем количество встречанных ip
в словарь записаваем значения по количеству встречаемых методов по типу
через Counter и most_common из списка ip собираем словарь, выбираем 5 значений с максимальных количеством обращений по данным ip в логе
формируем данные для вывода 5 самых долгих запросов по времени и по ошибкам в запросе
сортируем список с данными по времени выбираем 5 записей, создаем строку где пишем ip, метод, url, время запроса
выбираем в список записи, у которых код не равен 200, конвертируем эти данные в строку где пишем ip, метод, url, код
выводим все данные на печать